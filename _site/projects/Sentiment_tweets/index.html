<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.551">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Elena Bateman, Priyanka Iragavarapu, Rebekah Limb, Alyssa Lung, Misha Reiss, Ethan Warren">
<meta name="dcterms.date" content="2024-03-22">
<meta name="description" content="Analysis of public stigma in response to athletes’ mental health through tweets about Simone Biles during the 2020 Olympics.">

<title>Mental Gymnastics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../styles.css">
<meta name="citation_title" content="Mental Gymnastics">
<meta name="citation_author" content="Elena Bateman, Priyanka Iragavarapu, Rebekah Limb, Alyssa Lung, Misha Reiss, Ethan Warren">
<meta name="citation_publication_date" content="2024-03-22">
<meta name="citation_cover_date" content="2024-03-22">
<meta name="citation_year" content="2024">
<meta name="citation_online_date" content="2024-03-22">
<meta name="citation_language" content="en">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../projects/index.html"> 
<span class="menu-text">Projects</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-bi-github" role="button" data-bs-toggle="dropdown" aria-expanded="false">
      <i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-bi-github">    
        <li>
    <a class="dropdown-item" href="https://github.com/ethanmwarren/personal-website">
 <span class="dropdown-text">Website Source Code</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://github.com/ethanmwarren">
 <span class="dropdown-text">Github Profile</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#methodology" id="toc-methodology" class="nav-link" data-scroll-target="#methodology">Methodology</a>
  <ul class="collapse">
  <li><a href="#data-collection" id="toc-data-collection" class="nav-link" data-scroll-target="#data-collection">Data Collection</a></li>
  <li><a href="#exploratory-data-analysis" id="toc-exploratory-data-analysis" class="nav-link" data-scroll-target="#exploratory-data-analysis">Exploratory Data Analysis</a></li>
  <li><a href="#natural-language-processing" id="toc-natural-language-processing" class="nav-link" data-scroll-target="#natural-language-processing">Natural Language Processing</a></li>
  </ul></li>
  <li><a href="#results" id="toc-results" class="nav-link" data-scroll-target="#results">Results</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Mental Gymnastics</h1>
  <div class="quarto-categories">
    <div class="quarto-category">sentiment analysis</div>
    <div class="quarto-category">linguistics</div>
    <div class="quarto-category">topic modelling</div>
  </div>
  </div>

<div>
  <div class="description">
    Analysis of public stigma in response to athletes’ mental health through tweets about Simone Biles during the 2020 Olympics.
  </div>
</div>


<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Elena Bateman, Priyanka Iragavarapu, Rebekah Limb, Alyssa Lung, Misha Reiss, Ethan Warren </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">March 22, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="simone-biles.jpg" class="img-fluid figure-img"></p>
<figcaption>Simone Biles completing a beam routine at the Tokyo 2020 Olympics, days before dropping out due to mental health concerns.</figcaption>
</figure>
</div>
<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>In recent years, the intersection of mental health and athletic performance has garnered significant attention, particularly within the context of high-profile athletes. Recent discussions are challenging existing stigmas and promoting a new culture of openness and support. This study focuses on analyzing public sentiment towards the mental health of athletes by examining tweets posted about Simone Biles after <a href="https://www.nytimes.com/2021/07/28/sports/olympics/simone-biles-out.html">dropping out of the Olympic competition in Tokyo</a>, following mental health concerns.</p>
<p>Simone Biles’ public discourse provides a rich playground for exploring societal attitudes towards mental health in the sports domain, using twitter as proxy for public response. Utilizing natural language processing techniques (NLP), this report examines the nuances of public opinion, shedding light on prevalent themes and sentiments expressed on social media. Understanding these perspectives is crucial for addressing stigma and promoting mental health awareness among athletes. This study aims to contribute to the broader conversation on mental health in sports, offering insights into the public’s response to athletes’ mental health challenges. Click <a href="www.example.com">here</a> to find the gihub for the project where all the code and documentation can be found, and click <a href="netlify.ethanwarren.app/projects/Sentiment_tweets#Results">here</a> to skip over the methodology and go straight to the results.</p>
<section id="project-overview" class="level4">
<h4 class="anchored" data-anchor-id="project-overview">Project Overview</h4>
<p>The primary objective is to understand how public discourse, as seen in Twitter social media, frames mental health issues within the realm of professional international sports. We use sentiment analysis to capture the attitude of the public’s reaction. We then use topic modelling to identify common themes present in the tweets, and finally word vectorization to map topics to words and emotions.</p>
</section>
</section>
<section id="methodology" class="level2">
<h2 class="anchored" data-anchor-id="methodology">Methodology</h2>
<section id="data-collection" class="level3">
<h3 class="anchored" data-anchor-id="data-collection">Data Collection</h3>
<p>The dataset was compiled from public tweets using the Twitter API, isolating tweets mentioning gymnastics during the 2020 Summer Olympics. The collection period spanned from July 15 to August 14, 2021, capturing the timeline of Simone Biles’s participation and subsequent withdrawal. The dataset contains around 16.5K tweets. The features present in this dataset include: the textual content of each tweet, any entities present (hashtags, mentions, urls, etc.), the time posted, and the unique twitter ID of both the author and the tweet.</p>
<p>Notably, any information related to engagement metrics, i.e.&nbsp;likes, comments, replies, and retweets, is not part of the dataset. This required us to direct our analytical focus towards natural language processing due to the data’s qualitative nature.</p>
<p><strong>The cleaned data consisted of the following fields:</strong></p>
<table style="border: 1px solid black; width: 70%; margin-left: 40px; text-align: left; border-collapse: collapse;">
<tbody><tr>
<th style="border: 1px solid black; padding: 4px;">
Variable
</th>
<th style="border: 1px solid black; padding: 4px;">
Description
</th>
</tr>
<tr>
<td style="border: 1px solid black; padding: 4px;">
Text
</td>
<td style="border: 1px solid black; padding: 4px;">
Content of the tweet
</td>
</tr>
<tr>
<td style="border: 1px solid black; padding: 4px;">
Entities
</td>
<td style="border: 1px solid black; padding: 4px;">
Various entities mentioned in the tweet, such as hashtags and annotations
</td>
</tr>
<tr>
<td style="border: 1px solid black; padding: 4px;">
Time
</td>
<td style="border: 1px solid black; padding: 4px;">
The time the tweet was posted
</td>
</tr>
<tr>
<td style="border: 1px solid black; padding: 4px;">
Other
</td>
<td style="border: 1px solid black; padding: 4px;">
Other information, e.g.&nbsp;unique tweet ID, author ID, and edit history were not utilized in this analysis
</td>
</tr>
</tbody></table>
</section>
<section id="exploratory-data-analysis" class="level3">
<h3 class="anchored" data-anchor-id="exploratory-data-analysis">Exploratory Data Analysis</h3>
<p>We began our analysis by exploring the dataset to understand the dataset on a broad level before diving into an analysis. We began by creating a word cloud of the tweet textual data.</p>
<figure style="text-align: center;" class="figure">
<img src="wordcloud.png" alt="Word Cloud" width="500" class="figure-img">
<figcaption>
Fig 1. Word Cloud
</figcaption>
</figure>
<p>Olympics, gymnastics, and Simone Biles are all central to this word cloud, indicating a high volume of tweets that contained these words. Other recurrent terms such as “tokyo2020,” “team,” “gold,” and “sport” further characterize the dataset’s focus around gymnastics and the Olympic Competition.</p>
<p>We then looked at the number of tweets per hour and how they evolved over time after Simone Biles made the announcement to drop out of the Olympics. The team used an eight-hour rolling mean to smooth out the curve over a longer time period while still retaining the shape of the data.</p>
<figure style="margin-right: 30px; text-align: center;" class="figure">
<img src="tweetvolume.png" alt="Graph showing the number of tweets over time, with a spike when Biles announces her drop out." width="600" class="figure-img">
<figcaption>
Fig 2. Tweet volume per 8 hours.
</figcaption>
</figure>
<p>We see a clear spike right after her announcement, indicating a public response on the day she decided to drop out; however, we also see the number of tweets decrease relatively quickly after August 27, returning to what seems to be normal olympic tweet volume after about a week, and then to low tweet activity after just 2 weeks. This suggests there was not a sustained public reaction.</p>
<p>Finally, we looked at the top 10 most common hashtags present.</p>
<figure style="margin-right: 30px; text-align: center;" class="figure">
<img src="hashtags.png" alt="Bar chart showing top 10 hashtags." width="700" class="figure-img">
<figcaption>
Fig 3. Bar Chart of Hashtags.
</figcaption>
</figure>
<p>We can see again an strong focus on gymnastics, with the olympics, and Simone Biles also being important hashtags. We see the first mention of mental health in the 9th most common hashtag, indicating that it is a relevant topic to this dataset, but appears not to be the primary focus of the tweets. With a better understanding of the content of the data, we move on to natural language processing.</p>
</section>
<section id="natural-language-processing" class="level3">
<h3 class="anchored" data-anchor-id="natural-language-processing">Natural Language Processing</h3>
<section id="preprocessing" class="level4">
<h4 class="anchored" data-anchor-id="preprocessing">Preprocessing</h4>
<p>To prepare for NLP, we further preprocessed the tweet data to standardize it, focusing on the pure textual content. We followed preprocessing protocol by first removing all punctuation and special characters, as well as any stop words like “the” and “and” which don’t carry meaningful information. Tweets were then lemmatized, breaking down words to their root form (e.g.&nbsp;‘flipping’ <span class="math inline">\(\rightarrow\)</span> ‘flip’), which typically improves NLP results. We did our best to remove junk tweets, and decided to remove all links and url patterns from the text as well, to focus on the textual content of each tweet.</p>
</section>
<section id="sentiment-analysis" class="level4">
<h4 class="anchored" data-anchor-id="sentiment-analysis">Sentiment Analysis</h4>
<p>For sentiment analysis, we employed the Valence Aware Dictionary and sEntiment Reasoner (VADER) tool, which is well-suited for social media text due to its consideration of contextual polarity and intensity. VADER assigns each tweet a sentiment score based on a predefined lexicon. The sentiment score ranges from -1 to 1, where:</p>
<ul>
<li><strong>Negative sentiment</strong>: Scores closer to -1 indicate negative sentiment.</li>
<li><strong>Neutral sentiment</strong>: Scores around 0 indicate neutral sentiment.</li>
<li><strong>Positive sentiment</strong>: Scores closer to 1 indicate positive sentiment.</li>
</ul>
<p>Each tweet in the dataset was processed through the VADER tool to generate sentiment scores. The distribution of sentiment scores across the dataset was analyzed to identify overall trends and patterns. This analysis included calculating the proportion of positive, negative, and neutral tweets. The sentiment analysis results set the foundation for further investigation into the public’s perception of athletes’ mental health and provided a contextual basis for the subsequent topic modeling.</p>
</section>
<section id="non-negative-matrix-factorization" class="level4">
<h4 class="anchored" data-anchor-id="non-negative-matrix-factorization">Non-negative Matrix Factorization</h4>
<p>To further understand the themes and discussions within tweets about Simone Biles, we employed topic modeling, a technique designed to discover abstract topics within a collection of documents. This study utilized Non-Negative Matrix Factorization (NMF), a method that is particularly effective for high-dimensional text data, providing clearer and more interpretable topics.</p>
<p>While many topic modelling techniques were initially tested, like Latent Semantic Analysis (LSA) and Latent Dirichlet Allocation (LDA), NMF was chosen for its robustness in handling large text datasets and its ability to produce easily interpretable topics. NMF works by factorizing the term-document matrix into two lower-dimensional matrices: a term-topic matrix and a topic-document matrix. Each document (tweet) is represented as a mixture of topics, and each topic is represented as a mixture of terms.</p>
<p><strong>Implementation:</strong></p>
<ul>
<li><strong>Library</strong>: The NMF model was implemented using Python’s Scikit-learn library.</li>
<li><strong>Parameter Selection</strong>: The number of topics was determined by evaluating the coherence scores and conducting manual inspections to ensure meaningful and distinct topics.</li>
<li><strong>Process</strong>: The preprocessed tweet data was vectorized using Term Frequency-Inverse Document Frequency (TF-IDF) to create the term-document matrix. This matrix was then decomposed using NMF.</li>
</ul>
<p>The resulting topics were analyzed and labeled based on the most representative terms and example tweets for each topic. Each topic was defined by a set of high-weighted words, providing insights into the key themes discussed in relation to Simone Biles’ mental health.</p>
</section>
</section>
</section>
<section id="results" class="level2">
<h2 class="anchored" data-anchor-id="results">Results</h2>
<p>This allowed us to produce a histogram of sentiment scores for all tweets in the dataset.</p>
<figure style="margin-right: 30px; text-align: center;" class="figure">
<img src="Sentiment.png" alt="Histogram showing distribution of tweets' sentiment scores." width="700" class="figure-img">
<figcaption>
Fig 4. Histogram distribution of sentiment scores for tweets.
</figcaption>
</figure>
<p>Interestingly, this</p>
<p>.</p>
<p>. .</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>. .</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>. . . . . . . . . . . . .</p>
<p>To prepare the data for analysis we first extracted the entities from each tweet to store them individually to make analysis easier. Many features of the dataset were not utilized in this analysis - for example, columns relating to unique tweet and author ID numbers, IDs of referenced tweets, information about any withheld content, and the edit history of tweets.</p>
<p>Utilizing TextBlob, a python sentiment library, we were able to assign a sentiment score to each tweet, acting as an estimate of the overall positive or negative attitude. This is achieved with a word lexicon that assigns a score to most english words, and those scores are averaged to give an estimate of the overall sentiment of a tweet. With this we were able to give every tweet a sentiment score and analyze the changes and patterns in sentiments over time and within different groups.</p>
<p>NMF: <strong>Understanding the Output:</strong> - <strong>Top Words</strong>: The top words for each topic were examined to understand the main themes. - <strong>Example Tweets</strong>: Representative tweets were reviewed to provide context and validate the relevance of the topics. - <strong>Topic Distribution</strong>: The prevalence of each topic across the dataset was analyzed to identify dominant themes and trends over time.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p>© 2024, Ethan Warren</p>
</div>
  </div>
</footer>




</body></html>